{% extends "base.html" %}
{% block content %}
<div class="container">
  <h1>Booking Details</h1>
  <p><strong>Gig:</strong> <a href="{{ url_for('gig_detail', gig_id=booking.gig.id) }}">{{ booking.gig.title }}</a></p>
  <p><strong>Buyer:</strong> {{ booking.buyer.username }}</p>
  <p><strong>Booking Date:</strong> {{ booking.booking_date.strftime('%Y-%m-%d %H:%M') }}</p>
  <p><strong>Status:</strong> {{ booking.status }}</p>
  {% if current_user == booking.gig.seller and booking.status == 'Pending' %}
    <form method="post" action="{{ url_for('update_booking_status', booking_id=booking.id) }}">
      {{ form.hidden_tag() }}
      <button name="action" value="Confirm" class="btn btn-success">Confirm</button>
      <button name="action" value="Decline" class="btn btn-danger">Decline</button>
    </form>
  {% endif %}
    {% if current_user == booking.buyer and booking.status == 'Pending' %}
        <form action="{{ url_for('create_checkout_session', booking_id=booking.id) }}" method="POST">
            {{ form.hidden_tag() }}
            <button type="submit" class="btn btn-primary">Pay Now</button>
        </form>
    {% endif %}
</div>
{% endblock %}